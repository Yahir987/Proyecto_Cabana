<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas - Cabañas La Hacienda</title>
    <base target="_self">
    <link rel="stylesheet" href="/src/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <a href="/src/pages/index.html" class="logo">Cabañas La Hacienda</a>
            <nav class="nav">
                <button class="nav-toggle" aria-label="Abrir menú">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-menu">
                    <li><a href="/src/pages/index.html">Inicio</a></li>
                    <li><a href="/src/pages/galeria.html">Galería</a></li>
                    <li><a href="/src/pages/servicios.html">Servicios</a></li>
                    <li><a href="/src/pages/reservacion.html">Reservas</a></li>
                    <li><a href="/src/pages/ubicacion.html">Ubicación</a></li>
                    <li><a href="/src/pages/contacto.html">Contacto</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="section main-content-padding">
            <div class="container">
                <div class="section-title">
                    <h2>Realiza tu Reserva</h2>
                    <p>Completa el formulario para reservar tu cabaña ideal y planificar tu escapada.</p>
                </div>

                <div class="form-container reservation-form">
                    <h3>Detalles de la Reserva</h3>
                    <form id="reservation-form" onsubmit="enviarReserva(event)">
                        <div class="form-group">
                            <label for="nombre-reserva">Nombre Completo:</label>
                            <input type="text" id="nombre-reserva" name="nombre" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email-reserva">Correo Electrónico:</label>
                            <input type="email" id="email-reserva" name="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="telefono-reserva">Teléfono:</label>
                            <input type="tel" id="telefono-reserva" name="telefono" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="tipo-cabana">Tipo de Cabaña:</label>
                            <select id="tipo-cabana" name="tipoCabana" class="form-control" required>
                                <option value="">Selecciona una opción</option>
                                <option value="familiar">Cabaña Familiar</option>
                                <option value="romantica">Cabaña Romántica</option>
                                <option value="grupal">Cabaña Grupal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fecha-llegada">Fecha de Llegada:</label>
                            <input type="date" id="fecha-llegada" name="fechaLlegada" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="fecha-salida">Fecha de Salida:</label>
                            <input type="date" id="fecha-salida" name="fechaSalida" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="huespedes">Número de Huéspedes:</label>
                            <input type="number" id="huespedes" name="huespedes" class="form-control" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="comentarios">Comentarios Adicionales:</label>
                            <textarea id="comentarios" name="comentarios" rows="4" class="form-control"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Confirmar Reserva</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section about">
                    <h3>Cabañas La Hacienda</h3>
                    <p>Tu refugio perfecto en la naturaleza. Disfruta de la tranquilidad y belleza de nuestros entornos naturales.</p>
                    <div class="socials">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-section links">
                    <h3>Enlaces rápidos</h3>
                    <ul>
                        <li><a href="/src/pages/index.html">Inicio</a></li>
                        <li><a href="/src/pages/galeria.html">Galería</a></li>
                        <li><a href="/src/pages/servicios.html">Servicios</a></li>
                        <li><a href="/src/pages/reservacion.html">Reservas</a></li>
                        <li><a href="/src/pages/ubicacion.html">Ubicación</a></li>
                        <li><a href="/src/pages/contacto.html">Contacto</a></li>
                    </ul>
                </div>
                <div class="footer-section contact">
                    <h3>Contacto</h3>
                    <p><i class="fas fa-map-marker-alt"></i> Ruta 123, Valle del Bosque</p>
                    <p><i class="fas fa-phone"></i> +54 11 1234-5678</p>
                    <p><i class="fas fa-envelope"></i> info@cabanasdelbosque.com</p>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Cabañas La Hacienda. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
      (function() {
        // Usa el mismo User ID de EmailJS que usas para el formulario de contacto
        emailjs.init("rFedF0yAlJlIJYk1b"); // REEMPLAZA CON TU USER ID REAL DE EMAILJS
      })();

      function enviarReserva(e) {
        e.preventDefault();

        // Validar que la fecha de salida sea posterior a la fecha de llegada
        const fechaLlegadaInput = document.getElementById('fecha-llegada');
        const fechaSalidaInput = document.getElementById('fecha-salida');

        const fechaLlegada = new Date(fechaLlegadaInput.value);
        const fechaSalida = new Date(fechaSalidaInput.value);

        if (fechaSalida <= fechaLlegada) {
            alert('La fecha de salida debe ser posterior a la fecha de llegada.');
            return false; // Detener el envío del formulario
        }

        // Si la validación pasa, enviar con EmailJS
        emailjs.sendForm('service_4sse7ds', 'template_uf59j1m', '#reservation-form')
          .then(function(response) {
            alert('¡Tu solicitud de reserva ha sido enviada! Te contactaremos pronto ✅');
            document.getElementById("reservation-form").reset();
          }, function(error) {
            alert('Error al enviar la reserva ❌: ' + JSON.stringify(error));
          });
      }

      // Opcional: Deshabilitar fechas pasadas en los calendarios
      document.addEventListener('DOMContentLoaded', function() {
        const today = new Date();
        const yyyy = today.getFullYear();
        let mm = today.getMonth() + 1; // Months start at 0!
        let dd = today.getDate();

        if (dd < 10) dd = '0' + dd;
        if (mm < 10) mm = '0' + mm;

        const minDate = yyyy + '-' + mm + '-' + dd;

        document.getElementById('fecha-llegada').setAttribute('min', minDate);
        document.getElementById('fecha-salida').setAttribute('min', minDate);

        // Cuando cambia la fecha de llegada, ajustar la fecha mínima de salida
        document.getElementById('fecha-llegada').addEventListener('change', function() {
            const arrivalDate = new Date(this.value);
            arrivalDate.setDate(arrivalDate.getDate() + 1); // Salida debe ser al menos al día siguiente
            
            const arrivalDay = arrivalDate.getDate().toString().padStart(2, '0');
            const arrivalMonth = (arrivalDate.getMonth() + 1).toString().padStart(2, '0');
            const arrivalYear = arrivalDate.getFullYear();
            
            const minDepartureDate = `${arrivalYear}-${arrivalMonth}-${arrivalDay}`;
            document.getElementById('fecha-salida').setAttribute('min', minDepartureDate);

            // Asegurarse de que si la fecha de salida actual es anterior a la nueva mínima, se borre
            if (new Date(fechaSalidaInput.value) <= arrivalDate) {
                fechaSalidaInput.value = '';
            }
        });
      });
    </script>
    <script src="/src/js/main.js"></script>
</body>
</html>